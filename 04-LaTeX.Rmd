# LaTeX in Bookdown {#chapter5}

Bookdown offers powerful support for LaTeX, allowing you to seamlessly integrate any LaTeX packages you need into your documents. Whether you’re working with mathematical equations, theorems, lemmas, proofs, or other advanced features, this tutorial will guide you through the essentials of using LaTeX in Bookdown, showing you how to effectively incorporate and reference these elements.

---

## Including LaTeX Packages in Bookdown

One of the powerful features of Bookdown is its seamless integration with LaTeX, allowing you to include any LaTeX package that suits your needs. This flexibility is especially useful when working with advanced mathematical notations, custom formatting, or specialized content.

### Using a `preamble.tex` File

To include LaTeX packages, you need to create a `preamble.tex` file and link it in your `_output.yml` file. The `preamble.tex` file is processed before the document is rendered allowing you to load any additional LaTeX packages you may need. The `preamble.tex` file also allows you to fully cuztomize the output of your PDF using your existing LaTeX knowledge.

1. **Create a `preamble.tex` File**
Create a file on your computer with the name `preamble.tex` and add it to the directory of your Bookdown project if it does not already exist. If the file already exists simply open the file within RStudi for easy editing. You can include as many packages as you need in the `preamble.tex` file. For example here is a list of packages and small changes I made to output the final example document in this tutorial as an a6 sized document:
```latex
\usepackage{booktabs}
\usepackage{anyfontsize}
\usepackage{titlesec}
\usepackage{fancyhdr}
\usepackage[paperwidth=4.13in, paperheight=5.83in]{geometry}
\usepackage[font=small, labelfont=bf]{caption}
\geometry{left=.5in}
\geometry{right=.5in}
\geometry{bottom=.5in}
\geometry{top=.75in}
```

2. **Link `preamble.tex` in `_output.yml`**  
   You need to make sure that the preamble is included in your _output file. Update your `_output.yml` file to include the `preamble.tex` file for PDF output:
```markdown
bookdown::pdf_book:
  includes:
    in_header: preamble.tex
  latex_engine: xelatex
  citation_package: natbib
  keep_tex: yes
```

### Debugging Errors

If your document fails to compile, check the error message in the console or look at the `.log` file generated by LaTeX for troubleshooting.

By including custom LaTeX packages, you can extend the functionality of your Bookdown project to suit your unique requirements, whether it’s for academic papers, technical documents, or books.

## Mathematical Equations

Bookdown makes it easy to include both inline and display-style equations while also allowing you to reference these equations for easy reference at any point within your project.

### Inline Equations

Use `$...$` to include inline math equations within your text. The following code:

```markdown
The formula for the area of a circle is $( A = \pi r^2 )$, where $( r )$ is the radius.
```
Then is displayed as follows:

The formula for the area of a circle is $( A = \pi r^2 )$, where $( r )$ is the radius.


### Display Equations

For equations that you may want to have on their own line you have two options. You can surround your LaTeX code `$$...$$` or alternatively use the LaTeX `equation` environment.

Here we see the usage of `$$...$$`
```markdown
$$
E = mc^2
$$
```
Which gives us:

$$
E = mc^2
$$

Here we are using the `equation` environment with a label:

```markdown
\begin{equation}
  E = mc^2
  (\#eq:einstein)
\end{equation}
```

Which outputs as such:

\begin{equation}
  E = mc^2
  (\#eq:einstein)
\end{equation}


Reminder for referencing equations: For easy reference within your document we are also able to add a reference to any equation by using `\#eq:your-label` as such:

~~~
(\#eq:einstein)
~~~

So that you can easily reference it later with `\@ref(eq:einstein)`. As an example, we labeled the above equation as `(\#eq:einstein)`. So we can reference it by using `\@ref(eq:einstein)`:

```markdown
As shown in Equation \@ref(eq:einstein), energy is proportional to mass.
```

As shown in Equation \@ref(eq:einstein), energy is proportional to mass.


---

## Theorems, Lemmas, and Proofs

Bookdown supports theorems, lemmas, and proofs, for structured mathematical writing.

### Adding a Theorem

Define a theorem using the following syntax:

```markdown
::: {.theorem #theoremlabel}
This is a `theorem` environment that can contain **any**
_Markdown_ syntax.
For any integer $n \geq 1$, the sum of the first $n$ positive integers is given by
$$
S = \frac{n(n + 1)}{2}
$$
:::
```

Reference the theorem in your text  by add `#theoremlabel` to your code block as such:

```markdown
::: {.theorem #theoremlabel}
This is a `theorem` environment that can contain **any**
_Markdown_ syntax.
For any integer $n \geq 1$, the sum of the first $n$ positive integers is given by
$$
S = \frac{n(n + 1)}{2}
$$
:::
```

Which will cause your theorem to display as follows:

::: {.theorem #theoremlabel}
This is a `theorem` environment that can contain **any**
_Markdown_ syntax.
For any integer $n \geq 1$, the sum of the first $n$ positive integers is given by
$$
S = \frac{n(n + 1)}{2}
$$
:::

If this is a theorem that you need to reference in other parts of your document you can label it as we did above with `#theoremlabel`. Then when you need to reference it you can do so using `\@ref(thm:theoremlabel)` wherever needed. As an example, lets refer back to the above Theorem \@ref(thm:theoremlabel).



### Adding a Lemma

Define a lemma similarly:
```markdown
::: {.lemma #lemmalabel}
Let $x\in \mathbb Z$.If $5x-7$ is odd,then $x$ is even.
:::
```

::: {.lemma #lemmalabel}
Let $x \in \mathbb Z$. If $5x-7$ is odd,then $x$ is even.
:::


Reference the lemma:
```markdown
Lemma \@ref(lem:lemmalabel) confirms that the sum of two even integers is even.
```

Lemma \@ref(lem:lemmalabel) confirms that the sum of two even integers is even.

### Adding a Proof

Proofs can be added using the `proof` environment.


```markdown
::: {.proof}
\textbf{Proof: }Let $x \in \mathbb Z$. Suppose $7x+5$ is odd. Then $7x+5=2k+1$ for some $k \in \mathbb Z$. Then
\begin{align*}
    7x+5&=2k+1\\
    7x&=2k-4\\
    x&=2k-6x-4\\
    x&=2(k-3x-2).
\end{align*}
Since $k-3x-2 \in \mathbb Z$, $x$ is even.
:::
```

::: {.proof}
\textbf{Proof: }Let $x \in \mathbb Z$. Suppose $7x+5$ is odd. Then $7x+5=2k+1$ for some $k \in \mathbb Z$. Then
\begin{align*}
    7x+5&=2k+1\\
    7x&=2k-4\\
    x&=2k-6x-4\\
    x&=2(k-3x-2).
\end{align*}
Since $k-3x-2 \in \mathbb Z$, $x$ is even.
:::


---


### Referencing Various Math Environments

When you need to refer to create a different environment you just need to change what's between the brackets to the type of environment you are using.

```markdown
::: {.environment}
Your information goes here
:::
```
When you are referencing the environment you would just ensure that you use the label prefix from the below table for the environment you wish to reference, changing the word prefix in:`\@ref(prefix:label)` to the appropriate environment.


```{r theorem-table, echo=FALSE}
library(knitr)
kable(
  data.frame(
    Environment = c("theorem", "lemma", "corollary", "proposition", "conjecture", "definition", "example", "exercise", "hypothesis"),
    `Printed Name` = c("Theorem", "Lemma", "Corollary", "Proposition", "Conjecture", "Definition", "Example", "Exercise", "Hypothesis"),
    `Label Prefix` = c("thm", "lem", "cor", "prp", "cnj", "def", "exm", "exr", "hyp")
  ),
  col.names = c("Environment", "Printed Name", "Label Prefix"),
  caption = "Theorem environments in Bookdown.",
  booktabs = TRUE
)
```


## Tips for LaTeX in Bookdown

- **Use Labels Consistently**: Use meaningful and unique labels for cross-referencing.
- **Use Math Mode**: Always enclose mathematical symbols in `$...$` or `$$...$$` to render correctly.
- **Add Theorem Styles**: Customize theorem environments in `_bookdown.yml` for specific needs:
   ```markdown
   theorem:
     lab: "Theorem "
     lem: "Lemma "
   ```


:::: {.blackbox data-latex=""}
::: {.center data-latex=""}
**EXERCISE TIME!**
:::
Add an equation and a theorem to your document using LaTeX. Alternatively, copy over some LaTeX code you've written before and place it in one of your chapters.
::::